<div class="row">
    <div class="col">
        <div class="card">
            <div class="nav-body">
              <h5 class="nav-title">Vehicle</h5>
            </div>
          </div>
    </div>
</div>
<div class="row mt-3">
    <div class="col-12 col-lg-10">
        <div class='input-group form-group'>
            <input type="text" class="form-control-sm form-control" (input)="search()" placeholder="Search Plate #, Color, Year, Chassis #, VIN" [(ngModel)]="listingOption.search">
            <div class="input-group-prepend">
                <span class="input-group-text"><i class="fa fa-search"></i></span>
            </div>
        </div>
    </div>
    <div class="col-12 col-md-12 col-lg-2">
        <div class="navbar-collapse d-flex justify-content-end mt-2">
            <ul class="navbar-nav me-auto">
                <li class="nav-item drodpown profile-logo dropstart">
                    <a class="nav-link dropdown-toggle p-0 text-dark" href="#" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-download  mr-2"></i>Export
                    </a>
                    <div class="dropdown-menu dropdown-menu-dark dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item" href="#">Export to PDF</a>
                        <a class="dropdown-item" href="#">Export to Excel</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="row mt-1 mb-1">
    <div class="col-12 col-sm-6 col-lg-4">
        <div class="form-group">
            <label class="form-label">Make</label>
            <select class="form-control form-control-sm" name="vehicleMaker" (change)="loadContent()" [(ngModel)]="listingOption.vehicleMake">
                <option *ngFor="let item of vehicleMakes" [value]="item.id">{{ item.name }}</option>
            </select>
        </div>
        <div class="form-group">
            <label class="form-label">Model</label>
            <select class="form-control form-control-sm" name="vehicleModel" (change)="loadContent()" [(ngModel)]="listingOption.vehicleModel">
                <option *ngFor="let item of vehicleModels" [value]="item.id">{{ item.name }}</option>
            </select>
        </div>
    </div>
    <div class="col-12 col-sm-6 col-lg-4">
        <div class="form-group">
            <label class="form-label">Type</label>
            <select class="form-control form-control-sm" name="type" (change)="loadContent()" [(ngModel)]="listingOption.type">
                <option *ngFor="let item of types" [value]="item.id">{{ item.name }}</option>
            </select>
        </div>
        <div class="form-group">
            <label class="form-label">Gas Type</label>
            <select class="form-control form-control-sm" name="gasType" (change)="loadContent()" [(ngModel)]="listingOption.gasType">
                <option *ngFor="let item of gasTypes" [value]="item.id">{{ item.name }}</option>
            </select>
        </div>
    </div>
    <div class="col-12 col-sm-6 col-lg-4">
        <div class="form-group">
            <label class="form-label">Registry Expiration Date From</label>
            <input type="date" name="registryExpirationFrom" class="form-control form-control-sm" placeholder="Registration Expiration Date From" (change)="loadContent()" [(ngModel)]="listingOption.registryExpirationFrom">
        </div>
        <div class="form-group">
            <label class="form-label">Registry Expiration Date To</label>
            <input type="date" name="registryExpirationTo" class="form-control form-control-sm" placeholder="Registration Expiration Date To" (change)="loadContent()" [(ngModel)]="listingOption.registryExpirationTo">
        </div>
    </div>
</div>
<div class="row mt-1 mb-1">
    <div class="col-12 col-sm-6 col-lg-4">
        <div class="form-group">
            <label class="form-label">Registry Date From</label>
            <input type="date" name="registrationDateFrom" class="form-control form-control-sm" placeholder="Registration Date From" (change)="loadContent()" [(ngModel)]="listingOption.registryDateFrom">
        </div>
        <div class="form-group">
            <label class="form-label">Registry Date To</label>
            <input type="date" name="registrationDateFromTo" class="form-control form-control-sm" placeholder="Registration Date To" (change)="loadContent()" [(ngModel)]="listingOption.registryDateTo">
        </div>
    </div>
    <div class="col-12 col-sm-6 col-lg-4">
        <div class="form-group">
            <label class="form-label">Last Maintennance Date From</label>
            <input type="date" name="lastMaintennanceDateFrom" class="form-control form-control-sm" placeholder="Last Maintennance Date From" (change)="loadContent()" [(ngModel)]="listingOption.lastMaintennanceDateFrom">
        </div>
        <div class="form-group">
            <label class="form-label">Last Maintennance Date To</label>
            <input type="date" name="lastMaintennanceDateTo" class="form-control form-control-sm" placeholder="Last Maintennance Date To" (change)="loadContent()" [(ngModel)]="listingOption.lastMaintennanceDateTo">
        </div>
    </div>
    <div class="col-12 col-sm-6 col-lg-4">
        <div class="form-group">
            <label class="form-label">Transmission</label>
            <select class="form-control form-control-sm" name="transmission" (change)="loadContent()" [(ngModel)]="listingOption.transmission">
                <option [value]="Transmission.Manual">Manual</option>
                <option [value]="Transmission.Automatic">Automatic</option>
            </select>
        </div>
        <div class="form-group">
            <label class="form-label">Status</label>
            <select class="form-control form-control-sm" name="status" (change)="loadContent()" [(ngModel)]="listingOption.status">
                <option [value]="VehicleStat.Active">Active</option>
                <option [value]="VehicleStat.ForMaintennance">For Maintennance</option>
                <option [value]="VehicleStat.OnMaintennance">On Maintennance</option>
            </select>
        </div>
    </div>
</div>
<div class="row mt-4 mb-5">
    <div class="col-12">
        <div class="loader" *ngIf="isLoading">
            <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table">
                <tr>
                    <th class="w-150">Plate #</th>
                    <th (click)="sortBy('make')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'make'" [description]="'Make'"></th-arrow></th>
                    <th (click)="sortBy('model')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'model'" [description]="'Model'"></th-arrow></th>
                    <th (click)="sortBy('gasType')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'gasType'" [description]="'Gas Type'"></th-arrow></th>
                    <th>Chassis #</th>
                    <th (click)="sortBy('transmission')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'transmission'" [description]="'Transmission'"></th-arrow></th>
                    <th>VIN</th>
                    <th class="text-right" (click)="sortBy('price')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'price'" [description]="'Price'"></th-arrow></th>
                    <th class="text-right" (click)="sortBy('maxLoad')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'maxLoad'" [description]="'Max Load'"></th-arrow></th>
                    <th class="text-right" (click)="sortBy('mileAge')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'mileAge'" [description]="'MIleage'"></th-arrow></th>
                    <th class="w-150" (click)="sortBy('registrationDate')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'registrationDate'" [description]="'Registration Date'"></th-arrow></th>
                    <th class="w-150" (click)="sortBy('expirationDate')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'expirationDate'" [description]="'Registry Expiration Date'"></th-arrow></th>
                    <th class="w-150" (click)="sortBy('lastMaintennanceDate')"><th-arrow [sortDirection]="sortDirection" [sort]="this.listingOption.sortBy" [name]="'lastMaintennanceDate'" [description]="'Last Maintennance Date'"></th-arrow></th>
                </tr>
                <tr *ngFor="let vehicle of vehicles">
                    <td>
                        <a [href]="'admin/vehicles/'+vehicle.id">{{ vehicle.plateNumber }}</a><br>
                        <span class="field-value" [innerHTML]="VehicleStatus.format(vehicle.status)"></span><br>
                        <b>Color:</b> {{ vehicle.color }}<br>
                        <b>Year:</b> {{ vehicle.year }}
                    </td>
                    <td>{{ vehicle.vehicleMake.name }}</td>
                    <td>{{ vehicle.vehicleModel.name }}</td>
                    <td>{{ vehicle.gasType.name }}</td>
                    <td>{{ vehicle.chassisNumber }}</td>
                    <td>{{ Transmissions.format(vehicle.transmission) }}</td>
                    <td>{{ vehicle.vin }}</td>
                    <td class="text-right">{{ vehicle.price | currency:' ':'symbol':'0.2-2' }}</td>
                    <td class="text-right">{{ vehicle.maxLoad | currency:' ':'symbol':'0.0-1' }}</td>
                    <td class="text-right">{{ vehicle.mileAge | currency:' ':'symbol':'0.0-1' }}</td>
                    <td>{{ vehicle.registryDate | date }}</td>
                    <td>{{ vehicle.registryExpiration | date }}</td>
                    <td>{{ vehicle.lastMaintennanceDate | date }}</td>
                </tr>
            </table>
        </div>
        <app-pagination *ngIf="onLoaded && vehicles.length > 0" [result]="vehicles" (pageChanged)="navigate($event)"></app-pagination>
    </div>
</div>
